<!DOCTYPE HTML>
<html>

<head>
  <meta charset="UTF-8">
  <title>Register Gingko</title>
<style>
body {
  background-color: lightgray;
  padding: 20px;
}

.dialog-buttons {
  display: flex;
  flex-direction: row;
  justify-content: flex-end;
}
.dialog-buttons button {
  padding: 10px;
  min-width: 80px;
  margin-left: 10px;
}
</style>
</head>

<body>
  <script type="text/javascript">
    const ipc = require('electron').ipcRenderer

    sendSerialInfo = () => {
      var email = document.getElementById('email').value.toLowerCase()
      var serial = document.getElementById('serial').value.toUpperCase()
      ipc.send('serial', [email, serial])
    }

    cancel = () => {
      this.close()
    }

    ipc.on('serial-info', (e,d) => {
      document.getElementById('email').value = d[0]
      document.getElementById('serial').value = d[1]
    })

    ipc.on('serial-success', () => {
      alert('Thank you for contribution!')
      window.onbeforeunload = undefined
      this.close()
    })
    ipc.on('serial-fail', () => {
      alert('Invalid serial.\nPlease try again.')
    })
    ipc.on('prevent-close', () => {
      document.getElementById('cancel').disabled = true
      window.onbeforeunload = (e) => {
        e.returnValue = false
      }
    })

  </script>

  <form>
    <label for="email">Email:</label>
    <input id="email" style="display:block;width:380px;font-size:150%;" autofocus/>
    <br>
    <label for="serial">Serial:</label>
    <input id="serial" style="display:block;width:380px;font-size:150%;" autofocus/>
  </form>
  <br>
  <hr>
  <div class="dialog-buttons">
    <button id="cancel" onclick="cancel()" style="margin-top:5px;font-size:100%">Cancel</button>
    <button onclick="sendSerialInfo()" style="margin-top:5px;font-size:100%">Ok</button>
  </div>
</body>
</html>
